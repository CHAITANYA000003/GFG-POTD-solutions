The code has several comments and is self-explanatory.
The code will work only for NON-NEGATIVE NODE VALUES.
The code for all values needs to be learned.